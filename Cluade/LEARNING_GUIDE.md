# AUGAN学习指南

## 🎯 学习目标
理解AUGAN如何将低质量单角度超声图像转换为高质量多角度超声图像

## 📚 学习路径

### 第一阶段：数据理解 (1-2天)
**目标：理解超声成像原理和数据格式**

1. **`cubdl/README.md`** - 超声成像基础概念
   - 重点：PICMUS数据格式
   - 重点：平面波成像原理
   - 重点：IQ数据含义

2. **`cubdl/example_picmus_torch.py`** - 数据加载和重建
   - 重点：`load_datasets()`函数 (第21行)
   - 重点：`create_network()`函数 (第36行) 
   - 重点：`mk_img()`函数 (第56行)

3. **`data_process.py`** - 数据预处理流程
   - 重点：`create_das_reconstructions()`函数 (第135行)
   - 重点：`preprocess_images()`函数 (第198行)
   - 重点：`load_dataset()`函数 (第328行)

### 第二阶段：模型架构 (2-3天)  
**目标：理解Pix2Pix GAN架构**

1. **`models/base_model.py`** - 模型基类设计
   - 重点：抽象基类设计思想 (第16-38行)
   - 重点：模型生命周期管理
   - 重点：GPU/CPU设备管理

2. **`models/pix2pix_model.py`** - 核心GAN实现
   - 重点：模型初始化 (第88行)
   - 重点：前向传播 (第198行)
   - 重点：判别器训练 (第223行)
   - 重点：生成器训练 (第263行)
   - 重点：参数优化流程 (第314行)

3. **`models/network.py`** - 网络架构定义
   - 重点：U-Net生成器结构
   - 重点：PatchGAN判别器结构
   - 重点：网络初始化方法

### 第三阶段：训练流程 (1-2天)
**目标：理解GAN训练过程**

1. **`train.py`** - 主训练脚本
   - 重点：数据加载配置 (第81行)
   - 重点：训练循环 (第112行)
   - 重点：损失监控和保存

2. **`options/`** - 配置管理系统
   - 重点：参数定义和默认值
   - 重点：训练和测试选项区别

### 第四阶段：测试评估 (1天)
**目标：理解模型评估方法**

1. **`test.py`** - 测试脚本
   - 重点：模型加载和推理 (第122行)
   - 重点：结果保存和可视化

2. **`cubdl/metrics.py`** - 评估指标
   - 重点：CNR, gCNR, SNR, PSNR等指标

## 🔍 关键概念理解

### 数据流程
```
PICMUS原始数据 → DAS重建 → 单角度图像(输入A) 
                        → 多角度图像(目标B)
                        ↓
                    数据预处理(padding/normalize)
                        ↓
                    训练数据集(A→B的映射对)
```

### 模型架构
```
输入A → U-Net生成器 → 生成B'
       ↓
[A,B']和[A,B] → PatchGAN判别器 → 真假判别
```

### 损失函数
```
总损失 = GAN损失(对抗) + L2损失(像素) + VGG损失(感知)
```

## 💻 实践建议

1. **先跑通代码**: 用小数据集快速训练几个epoch
2. **修改参数**: 尝试不同的网络架构和超参数  
3. **可视化结果**: 查看生成的图像质量
4. **分析损失**: 观察训练过程中的损失变化

## 🛠️ 调试技巧

- 使用`--print_freq 1`查看每个batch的训练信息
- 检查`./images/experiment_name/`目录的可视化结果
- 监控GPU显存使用情况避免OOM
- 从小数据集和少epoch开始测试

## ❓ 常见问题

1. **数据维度错误**: 检查图像padding是否正确
2. **GPU内存不足**: 减小batch_size或使用CPU
3. **训练不收敛**: 调整学习率和损失权重
4. **生成图像模糊**: 检查感知损失是否生效

记住：理解比记忆更重要，重点理解每个模块的作用和数据流向！